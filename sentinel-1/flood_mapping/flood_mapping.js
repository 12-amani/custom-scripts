/*
Author of the script: Maryam Salehi 
// Website: https://www.researchgate.net/profile/Maryam_Salehi13
*/

// ***
// Sentinel-1 Multi-temporal Processing for Flood Mapping
// The script takes two dates (before and during the flood) as an input and it needs to be processed in Sentinel Playground.
// The examples are here: 
// case 1: https://apps.sentinel-hub.com/sentinel-playground-temporal/?source=S1-AWS-IW-VVVH&lat=37.009357015982836&lng=54.18366523459554&zoom=11&preset=CUSTOM&layers=VV,VV,VV&maxcc=100&gain=1.0&gamma=1.0&time=2017-01-01%7C2019-03-30&atmFilter=&showDates=false&evalscript=Ly8gRGF0ZSBEZWZpbml0aW9uIAp2YXIgYmVmb3JlZmxvb2RfZGF0ZSA9ICIyMDE5LTAzLTExIjsgdmFyIGR1cmluZ2Zsb29kX2RhdGUgPSAiMjAxOS0wMy0yMyI7IC8vIEZsb29kIGluIEFnaGdoYWxhLCBJcmFuICAgICAKLy92YXIgYmVmb3JlZmxvb2RfZGF0ZSA9ICIyMDE5LTAxLTA2IjsgdmFyIGR1cmluZ2Zsb29kX2RhdGUgPSAiMjAxOS0wMS0xNCI7IC8vIEZsb29kIGluIFVydWd1YWlhbmEsIFJpbyBHcmFuZGUgZG8gU3VsLCBCcmF6aWwgICAgICAgCi8vdmFyIGJlZm9yZWZsb29kX2RhdGUgPSAiMjAyMC0wMS0wNCI7IHZhciBkdXJpbmdmbG9vZF9kYXRlID0gIjIwMjAtMDEtMTMiOyAvLyBGbG9vZCBpbiBzb3V0aGVybiBJcmFuCiAKLy8gU2VsZWN0aW9uIG9mIHBvbGFyaXphdGlvbiAKZnVuY3Rpb24gc2V0dXAgKGRzcykgewogIHNldElucHV0Q29tcG9uZW50cyhbZHNzLlZWXSk7CiAgc2V0T3V0cHV0Q29tcG9uZW50Q291bnQoMyk7ICAvLyByZXR1cm4gYXMgUkdCCn0KCmZ1bmN0aW9uIGZpbHRlclNjZW5lcyAoc2NlbmVzKSB7ICAKcmV0dXJuIHNjZW5lcy5maWx0ZXIoZnVuY3Rpb24gKHNjZW5lKSB7Ci8vIHNldCBkYXRlcyBmb3IgYmVmb3JlLWFuZC1kdXJpbmcgZmxvb2QgYW5hbHlzaXMKdmFyIGFsbG93ZWREYXRlcyA9IFtiZWZvcmVmbG9vZF9kYXRlLGR1cmluZ2Zsb29kX2RhdGVdOyAKdmFyIHNjZW5lRGF0ZVN0ciA9IGRhdGVmb3JtYXQoc2NlbmUuZGF0ZSk7CmlmIChhbGxvd2VkRGF0ZXMuaW5kZXhPZihzY2VuZURhdGVTdHIpIT0gLTEpIHJldHVybiB0cnVlOwplbHNlIHJldHVybiBmYWxzZTsKICB9KTsKfQoKLy8gRmxvb2QgbWFwcGluZwpmdW5jdGlvbiBjYWxjRk0oc2FtcGxlKSB7CiAgdmFyIG91dHZ2ID0gc2FtcGxlLlZWOwogIHJldHVybiBbMS41Km91dHZ2XTsKfQoKZnVuY3Rpb24gZGF0ZWZvcm1hdChkKXsgIAogIHZhciBkZCA9IGQuZ2V0RGF0ZSgpOwogIHZhciBtbSA9IGQuZ2V0TW9udGgoKSsxOwogIHZhciB5eXl5ID0gZC5nZXRGdWxsWWVhcigpOwogIGlmKGRkPDEwKXtkZD0nMCcrZGR9CiAgaWYobW08MTApe21tPScwJyttbX0KICB2YXIgaXNvZGF0ZSA9IHl5eXkrJy0nK21tKyctJytkZDsKICByZXR1cm4gaXNvZGF0ZTsKfQoKZnVuY3Rpb24gZXZhbHVhdGVQaXhlbChzYW1wbGVzLHNjZW5lcykgeyAgCiAgdmFyIG91dGJlID0gMDsKICB2YXIgb3V0ZHUgPSAwOyAgCiAgLy8gYmVmb3JlLWZsb29kIGltYWdlCiAgb3V0YmUgPSBjYWxjRk0oc2FtcGxlc1sxXSk7CiAgLy8gZHVyaW5nLWZsb29kIGltYWdlCiAgb3V0ZHUgPSBjYWxjRk0oc2FtcGxlc1swXSk7ICAKICByZXR1cm4gW291dGJlLG91dGR1LG91dGR1XQogLy8gKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCiAvLyBtYXNrIGNyZWF0aW9uCiAvLyB2YXIgZG91dCA9IG91dGJlIC0gb3V0ZHU7ICAgIAogLy8gcmV0dXJuIFtkb3V0ID4gMC4wNSA%2FICAxIDogMF0KIC8vICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgp9Cg%3D%3D&temporal=true
// case 2: https://apps.sentinel-hub.com/sentinel-playground-temporal/?source=S1-AWS-IW-VVVH&lat=25.23665005236088&lng=61.36307455133647&zoom=11&preset=CUSTOM&layers=VV,VV,VV&maxcc=100&gain=1.0&gamma=1.0&time=2017-01-01%7C2020-01-25&atmFilter=&showDates=false&evalscript=Ly8gRGF0ZSBEZWZpbml0aW9uIAovL3ZhciBiZWZvcmVmbG9vZF9kYXRlID0gIjIwMTktMDMtMTEiOyB2YXIgZHVyaW5nZmxvb2RfZGF0ZSA9ICIyMDE5LTAzLTIzIjsgLy8gRmxvb2QgaW4gQWdoZ2hhbGEsIElyYW4gICAgIAovL3ZhciBiZWZvcmVmbG9vZF9kYXRlID0gIjIwMTktMDEtMDYiOyB2YXIgZHVyaW5nZmxvb2RfZGF0ZSA9ICIyMDE5LTAxLTE0IjsgLy8gRmxvb2QgaW4gVXJ1Z3VhaWFuYSwgUmlvIEdyYW5kZSBkbyBTdWwsIEJyYXppbCAgICAgICAKdmFyIGJlZm9yZWZsb29kX2RhdGUgPSAiMjAyMC0wMS0wNCI7IHZhciBkdXJpbmdmbG9vZF9kYXRlID0gIjIwMjAtMDEtMTMiOyAvLyBGbG9vZCBpbiBzb3V0aGVybiBJcmFuCiAKLy8gU2VsZWN0aW9uIG9mIHBvbGFyaXphdGlvbiAKZnVuY3Rpb24gc2V0dXAgKGRzcykgewogIHNldElucHV0Q29tcG9uZW50cyhbZHNzLlZWXSk7CiAgc2V0T3V0cHV0Q29tcG9uZW50Q291bnQoMyk7ICAvLyByZXR1cm4gYXMgUkdCCn0KCmZ1bmN0aW9uIGZpbHRlclNjZW5lcyAoc2NlbmVzKSB7ICAKcmV0dXJuIHNjZW5lcy5maWx0ZXIoZnVuY3Rpb24gKHNjZW5lKSB7Ci8vIHNldCBkYXRlcyBmb3IgYmVmb3JlLWFuZC1kdXJpbmcgZmxvb2QgYW5hbHlzaXMKdmFyIGFsbG93ZWREYXRlcyA9IFtiZWZvcmVmbG9vZF9kYXRlLGR1cmluZ2Zsb29kX2RhdGVdOyAKdmFyIHNjZW5lRGF0ZVN0ciA9IGRhdGVmb3JtYXQoc2NlbmUuZGF0ZSk7CmlmIChhbGxvd2VkRGF0ZXMuaW5kZXhPZihzY2VuZURhdGVTdHIpIT0gLTEpIHJldHVybiB0cnVlOwplbHNlIHJldHVybiBmYWxzZTsKICB9KTsKfQoKLy8gRmxvb2QgbWFwcGluZwpmdW5jdGlvbiBjYWxjRk0oc2FtcGxlKSB7CiAgdmFyIG91dHZ2ID0gc2FtcGxlLlZWOwogIHJldHVybiBbMS41Km91dHZ2XTsKfQoKZnVuY3Rpb24gZGF0ZWZvcm1hdChkKXsgIAogIHZhciBkZCA9IGQuZ2V0RGF0ZSgpOwogIHZhciBtbSA9IGQuZ2V0TW9udGgoKSsxOwogIHZhciB5eXl5ID0gZC5nZXRGdWxsWWVhcigpOwogIGlmKGRkPDEwKXtkZD0nMCcrZGR9CiAgaWYobW08MTApe21tPScwJyttbX0KICB2YXIgaXNvZGF0ZSA9IHl5eXkrJy0nK21tKyctJytkZDsKICByZXR1cm4gaXNvZGF0ZTsKfQoKZnVuY3Rpb24gZXZhbHVhdGVQaXhlbChzYW1wbGVzLHNjZW5lcykgeyAgCiAgdmFyIG91dGJlID0gMDsKICB2YXIgb3V0ZHUgPSAwOyAgCiAgLy8gYmVmb3JlLWZsb29kIGltYWdlCiAgb3V0YmUgPSBjYWxjRk0oc2FtcGxlc1sxXSk7CiAgLy8gZHVyaW5nLWZsb29kIGltYWdlCiAgb3V0ZHUgPSBjYWxjRk0oc2FtcGxlc1swXSk7ICAKICByZXR1cm4gW291dGJlLG91dGR1LG91dGR1XQogLy8gKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCiAvLyBtYXNrIGNyZWF0aW9uCiAvLyB2YXIgZG91dCA9IG91dGJlIC0gb3V0ZHU7ICAgIAogLy8gcmV0dXJuIFtkb3V0ID4gMC4wNSA%2FICAxIDogMF0KIC8vICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgp9Cg%3D%3D&temporal=true
// case 3: https://apps.sentinel-hub.com/sentinel-playground-temporal/?source=S1-AWS-IW-VVVH&lat=-29.789205584310288&lng=-57.195479662623256&zoom=12&preset=CUSTOM&layers=VV,VV,VV&maxcc=100&gain=1.0&gamma=1.0&time=2017-01-01%7C2019-01-23&atmFilter=&showDates=false&evalscript=Ly8gRGF0ZSBEZWZpbml0aW9uIAovL3ZhciBiZWZvcmVmbG9vZF9kYXRlID0gIjIwMTktMDMtMTEiOyB2YXIgZHVyaW5nZmxvb2RfZGF0ZSA9ICIyMDE5LTAzLTIzIjsgLy8gRmxvb2QgaW4gQWdoZ2hhbGEsIElyYW4gICAgIAp2YXIgYmVmb3JlZmxvb2RfZGF0ZSA9ICIyMDE5LTAxLTA2IjsgdmFyIGR1cmluZ2Zsb29kX2RhdGUgPSAiMjAxOS0wMS0xNCI7IC8vIEZsb29kIGluIFVydWd1YWlhbmEsIFJpbyBHcmFuZGUgZG8gU3VsLCBCcmF6aWwgICAgICAgCi8vdmFyIGJlZm9yZWZsb29kX2RhdGUgPSAiMjAyMC0wMS0wNCI7IHZhciBkdXJpbmdmbG9vZF9kYXRlID0gIjIwMjAtMDEtMTMiOyAvLyBGbG9vZCBpbiBzb3V0aGVybiBJcmFuCiAKLy8gU2VsZWN0aW9uIG9mIHBvbGFyaXphdGlvbiAKZnVuY3Rpb24gc2V0dXAgKGRzcykgewogIHNldElucHV0Q29tcG9uZW50cyhbZHNzLlZWXSk7CiAgc2V0T3V0cHV0Q29tcG9uZW50Q291bnQoMyk7ICAvLyByZXR1cm4gYXMgUkdCCn0KCmZ1bmN0aW9uIGZpbHRlclNjZW5lcyAoc2NlbmVzKSB7ICAKcmV0dXJuIHNjZW5lcy5maWx0ZXIoZnVuY3Rpb24gKHNjZW5lKSB7Ci8vIHNldCBkYXRlcyBmb3IgYmVmb3JlLWFuZC1kdXJpbmcgZmxvb2QgYW5hbHlzaXMKdmFyIGFsbG93ZWREYXRlcyA9IFtiZWZvcmVmbG9vZF9kYXRlLGR1cmluZ2Zsb29kX2RhdGVdOyAKdmFyIHNjZW5lRGF0ZVN0ciA9IGRhdGVmb3JtYXQoc2NlbmUuZGF0ZSk7CmlmIChhbGxvd2VkRGF0ZXMuaW5kZXhPZihzY2VuZURhdGVTdHIpIT0gLTEpIHJldHVybiB0cnVlOwplbHNlIHJldHVybiBmYWxzZTsKICB9KTsKfQoKLy8gRmxvb2QgbWFwcGluZwpmdW5jdGlvbiBjYWxjRk0oc2FtcGxlKSB7CiAgdmFyIG91dHZ2ID0gc2FtcGxlLlZWOwogIHJldHVybiBbMS41Km91dHZ2XTsKfQoKZnVuY3Rpb24gZGF0ZWZvcm1hdChkKXsgIAogIHZhciBkZCA9IGQuZ2V0RGF0ZSgpOwogIHZhciBtbSA9IGQuZ2V0TW9udGgoKSsxOwogIHZhciB5eXl5ID0gZC5nZXRGdWxsWWVhcigpOwogIGlmKGRkPDEwKXtkZD0nMCcrZGR9CiAgaWYobW08MTApe21tPScwJyttbX0KICB2YXIgaXNvZGF0ZSA9IHl5eXkrJy0nK21tKyctJytkZDsKICByZXR1cm4gaXNvZGF0ZTsKfQoKZnVuY3Rpb24gZXZhbHVhdGVQaXhlbChzYW1wbGVzLHNjZW5lcykgeyAgCiAgdmFyIG91dGJlID0gMDsKICB2YXIgb3V0ZHUgPSAwOyAgCiAgLy8gYmVmb3JlLWZsb29kIGltYWdlCiAgb3V0YmUgPSBjYWxjRk0oc2FtcGxlc1sxXSk7CiAgLy8gZHVyaW5nLWZsb29kIGltYWdlCiAgb3V0ZHUgPSBjYWxjRk0oc2FtcGxlc1swXSk7ICAKICByZXR1cm4gW291dGJlLG91dGR1LG91dGR1XQogLy8gKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCiAvLyBtYXNrIGNyZWF0aW9uCiAvLyB2YXIgZG91dCA9IG91dGJlIC0gb3V0ZHU7ICAgIAogLy8gcmV0dXJuIFtkb3V0ID4gMC4wNSA%2FICAxIDogMF0KIC8vICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgp9Cg%3D%3D&temporal=true
// case 1_1: https://apps.sentinel-hub.com/sentinel-playground-temporal/?source=S1-AWS-IW-VVVH&lat=37.00118174037924&lng=54.134819651953876&zoom=11&preset=CUSTOM&layers=VV,VV,VV&maxcc=100&gain=1.0&gamma=1.0&time=2017-01-01%7C2019-03-30&atmFilter=&showDates=false&evalscript=Ly8gRGF0ZSBEZWZpbml0aW9uIAp2YXIgYmVmb3JlZmxvb2RfZGF0ZSA9ICIyMDE5LTAzLTExIjsgdmFyIGR1cmluZ2Zsb29kX2RhdGUgPSAiMjAxOS0wMy0yMyI7IC8vIEZsb29kIGluIEFnaGdoYWxhLCBJcmFuICAgICAKLy92YXIgYmVmb3JlZmxvb2RfZGF0ZSA9ICIyMDE5LTAxLTA2IjsgdmFyIGR1cmluZ2Zsb29kX2RhdGUgPSAiMjAxOS0wMS0xNCI7IC8vIEZsb29kIGluIFVydWd1YWlhbmEsIFJpbyBHcmFuZGUgZG8gU3VsLCBCcmF6aWwgICAgICAgCi8vdmFyIGJlZm9yZWZsb29kX2RhdGUgPSAiMjAyMC0wMS0wNCI7IHZhciBkdXJpbmdmbG9vZF9kYXRlID0gIjIwMjAtMDEtMTMiOyAvLyBGbG9vZCBpbiBzb3V0aGVybiBJcmFuCiAKLy8gU2VsZWN0aW9uIG9mIHBvbGFyaXphdGlvbiAKZnVuY3Rpb24gc2V0dXAgKGRzcykgewogIHNldElucHV0Q29tcG9uZW50cyhbZHNzLlZWXSk7CiAgc2V0T3V0cHV0Q29tcG9uZW50Q291bnQoMyk7ICAvLyByZXR1cm4gYXMgUkdCCn0KCmZ1bmN0aW9uIGZpbHRlclNjZW5lcyAoc2NlbmVzKSB7ICAKcmV0dXJuIHNjZW5lcy5maWx0ZXIoZnVuY3Rpb24gKHNjZW5lKSB7Ci8vIHNldCBkYXRlcyBmb3IgYmVmb3JlLWFuZC1kdXJpbmcgZmxvb2QgYW5hbHlzaXMKdmFyIGFsbG93ZWREYXRlcyA9IFtiZWZvcmVmbG9vZF9kYXRlLGR1cmluZ2Zsb29kX2RhdGVdOyAKdmFyIHNjZW5lRGF0ZVN0ciA9IGRhdGVmb3JtYXQoc2NlbmUuZGF0ZSk7CmlmIChhbGxvd2VkRGF0ZXMuaW5kZXhPZihzY2VuZURhdGVTdHIpIT0gLTEpIHJldHVybiB0cnVlOwplbHNlIHJldHVybiBmYWxzZTsKICB9KTsKfQoKLy8gRmxvb2QgbWFwcGluZwpmdW5jdGlvbiBjYWxjRk0oc2FtcGxlKSB7CiAgdmFyIG91dHZ2ID0gc2FtcGxlLlZWOwogIHJldHVybiBbMS41Km91dHZ2XTsKfQoKZnVuY3Rpb24gZGF0ZWZvcm1hdChkKXsgIAogIHZhciBkZCA9IGQuZ2V0RGF0ZSgpOwogIHZhciBtbSA9IGQuZ2V0TW9udGgoKSsxOwogIHZhciB5eXl5ID0gZC5nZXRGdWxsWWVhcigpOwogIGlmKGRkPDEwKXtkZD0nMCcrZGR9CiAgaWYobW08MTApe21tPScwJyttbX0KICB2YXIgaXNvZGF0ZSA9IHl5eXkrJy0nK21tKyctJytkZDsKICByZXR1cm4gaXNvZGF0ZTsKfQoKZnVuY3Rpb24gZXZhbHVhdGVQaXhlbChzYW1wbGVzLHNjZW5lcykgeyAgCiAgdmFyIG91dGJlID0gMDsKICB2YXIgb3V0ZHUgPSAwOyAgCiAgLy8gYmVmb3JlLWZsb29kIGltYWdlCiAgb3V0YmUgPSBjYWxjRk0oc2FtcGxlc1sxXSk7CiAgLy8gZHVyaW5nLWZsb29kIGltYWdlCiAgb3V0ZHUgPSBjYWxjRk0oc2FtcGxlc1swXSk7ICAKICAvL3JldHVybiBbb3V0YmUsb3V0ZHUsb3V0ZHVdCiAvLyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKIC8vIG1hc2sgY3JlYXRpb24KICB2YXIgZG91dCA9IG91dGJlIC0gb3V0ZHU7ICAgIAogIHJldHVybiBbZG91dCA%2BIDAuMDUgPyAgMSA6IDBdCiAvLyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKfQo%3D&temporal=true
// case 1_2: https://apps.sentinel-hub.com/sentinel-playground-temporal/?source=S1-AWS-IW-VVVH&lat=37.00118174037924&lng=54.134819651953876&zoom=11&preset=CUSTOM&layers=VV,VV,VV&maxcc=100&gain=1.0&gamma=1.0&time=2017-01-01%7C2019-03-30&atmFilter=&showDates=false&evalscript=Ly8gRGF0ZSBEZWZpbml0aW9uIAp2YXIgYmVmb3JlZmxvb2RfZGF0ZSA9ICIyMDE5LTAzLTExIjsgdmFyIGR1cmluZ2Zsb29kX2RhdGUgPSAiMjAxOS0wMy0yMyI7IC8vIEZsb29kIGluIEFnaGdoYWxhLCBJcmFuICAgICAKLy92YXIgYmVmb3JlZmxvb2RfZGF0ZSA9ICIyMDE5LTAxLTA2IjsgdmFyIGR1cmluZ2Zsb29kX2RhdGUgPSAiMjAxOS0wMS0xNCI7IC8vIEZsb29kIGluIFVydWd1YWlhbmEsIFJpbyBHcmFuZGUgZG8gU3VsLCBCcmF6aWwgICAgICAgCi8vdmFyIGJlZm9yZWZsb29kX2RhdGUgPSAiMjAyMC0wMS0wNCI7IHZhciBkdXJpbmdmbG9vZF9kYXRlID0gIjIwMjAtMDEtMTMiOyAvLyBGbG9vZCBpbiBzb3V0aGVybiBJcmFuCiAKLy8gU2VsZWN0aW9uIG9mIHBvbGFyaXphdGlvbiAKZnVuY3Rpb24gc2V0dXAgKGRzcykgewogIHNldElucHV0Q29tcG9uZW50cyhbZHNzLlZWXSk7CiAgc2V0T3V0cHV0Q29tcG9uZW50Q291bnQoMyk7ICAvLyByZXR1cm4gYXMgUkdCCn0KCmZ1bmN0aW9uIGZpbHRlclNjZW5lcyAoc2NlbmVzKSB7ICAKcmV0dXJuIHNjZW5lcy5maWx0ZXIoZnVuY3Rpb24gKHNjZW5lKSB7Ci8vIHNldCBkYXRlcyBmb3IgYmVmb3JlLWFuZC1kdXJpbmcgZmxvb2QgYW5hbHlzaXMKdmFyIGFsbG93ZWREYXRlcyA9IFtiZWZvcmVmbG9vZF9kYXRlLGR1cmluZ2Zsb29kX2RhdGVdOyAKdmFyIHNjZW5lRGF0ZVN0ciA9IGRhdGVmb3JtYXQoc2NlbmUuZGF0ZSk7CmlmIChhbGxvd2VkRGF0ZXMuaW5kZXhPZihzY2VuZURhdGVTdHIpIT0gLTEpIHJldHVybiB0cnVlOwplbHNlIHJldHVybiBmYWxzZTsKICB9KTsKfQoKLy8gRmxvb2QgbWFwcGluZwpmdW5jdGlvbiBjYWxjRk0oc2FtcGxlKSB7CiAgdmFyIG91dHZ2ID0gc2FtcGxlLlZWOwogIHJldHVybiBbMS41Km91dHZ2XTsKfQoKZnVuY3Rpb24gZGF0ZWZvcm1hdChkKXsgIAogIHZhciBkZCA9IGQuZ2V0RGF0ZSgpOwogIHZhciBtbSA9IGQuZ2V0TW9udGgoKSsxOwogIHZhciB5eXl5ID0gZC5nZXRGdWxsWWVhcigpOwogIGlmKGRkPDEwKXtkZD0nMCcrZGR9CiAgaWYobW08MTApe21tPScwJyttbX0KICB2YXIgaXNvZGF0ZSA9IHl5eXkrJy0nK21tKyctJytkZDsKICByZXR1cm4gaXNvZGF0ZTsKfQoKZnVuY3Rpb24gZXZhbHVhdGVQaXhlbChzYW1wbGVzLHNjZW5lcykgeyAgCiAgdmFyIG91dGJlID0gMDsKICB2YXIgb3V0ZHUgPSAwOyAgCiAgLy8gYmVmb3JlLWZsb29kIGltYWdlCiAgb3V0YmUgPSBjYWxjRk0oc2FtcGxlc1sxXSk7CiAgLy8gZHVyaW5nLWZsb29kIGltYWdlCiAgb3V0ZHUgPSBjYWxjRk0oc2FtcGxlc1swXSk7ICAKICAvL3JldHVybiBbb3V0YmUsb3V0ZHUsb3V0ZHVdCiAvLyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKIC8vIG1hc2sgY3JlYXRpb24KICB2YXIgZG91dCA9IG91dGJlIC0gb3V0ZHU7ICAgIAogIHJldHVybiBbZG91dCA%2BIDAuMDggPyAgMSA6IDBdCiAvLyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKfQo%3D&temporal=true
// ***

// Date Definition 
var beforeflood_date = "2019-03-11"; var duringflood_date = "2019-03-23"; // Flood in Aghghala, Iran     
//var beforeflood_date = "2019-01-06"; var duringflood_date = "2019-01-14"; // Flood in Uruguaiana, Rio Grande do Sul, Brazil       
//var beforeflood_date = "2020-01-04"; var duringflood_date = "2020-01-13"; // Flood in southern Iran
 
// Selection of polarization 
function setup (dss) {
  setInputComponents([dss.VV]);
  setOutputComponentCount(3);  // return as RGB
}

function filterScenes (scenes) {  
return scenes.filter(function (scene) {
// set dates for before-and-during flood analysis
var allowedDates = [beforeflood_date,duringflood_date]; 
var sceneDateStr = dateformat(scene.date);
if (allowedDates.indexOf(sceneDateStr)!= -1) return true;
else return false;
  });
}

// Flood mapping
function calcFM(sample) {
  var outvv = sample.VV;
  return [1.5*outvv];
}

function dateformat(d){  
  var dd = d.getDate();
  var mm = d.getMonth()+1;
  var yyyy = d.getFullYear();
  if(dd<10){dd='0'+dd}
  if(mm<10){mm='0'+mm}
  var isodate = yyyy+'-'+mm+'-'+dd;
  return isodate;
}

function evaluatePixel(samples,scenes) {  
  var outbe = 0;
  var outdu = 0;  
  // before-flood image
  outbe = calcFM(samples[1]);
  // during-flood image
  outdu = calcFM(samples[0]);  
  return [outbe,outdu,outdu]
 // ************************************
 // mask creation
 // var dout = outbe - outdu;    
 // return [dout > 0.05 ?  1 : 0]
 // ************************************
}
